#N canvas 257 117 726 577 12;
#X obj 20 20 midirealtimein;
#X obj 20 170 bng 15 50 10 0 empty empty empty 17 7 0 10 #fcfcfc #000000
#000000;
#X obj 270 323 tgl 15 0 empty empty empty 17 7 0 10 #fcfcfc #000000
#000000 0 1;
#X floatatom 340 293 5 0 0 0 - - -, f 5;
#X floatatom 340 350 5 0 0 0 - - -, f 5;
#X obj 340 321 expr 60000/$f1/24;
#X obj 270 350 metro 25;
#X obj 130 150 bng 15 250 50 0 empty empty stop 17 7 0 10 #fcfcfc #000000
#000000;
#X floatatom 150 277 5 0 0 0 - - -, f 5;
#X text 280 383 internal clock - for testing purposes, f 20;
#X obj 20 201 t b b b;
#X obj 20 230 outlet;
#X obj 150 300 outlet;
#X obj 20 49 spigot;
#X obj 400 20 inlet;
#X obj 400 49 tgl 15 0 empty empty empty 17 7 0 10 #fcfcfc #000000
#000000 1 1;
#X obj 200 100 loadbang;
#X obj 200 158 moses 1;
#X text 270 120 arg #1 initializes delay for auto-stop, f 22;
#X obj 217 270 outlet;
#X floatatom 20 430 5 0 0 0 - - -, f 5;
#X obj 20 79 sel 248 250 252;
#X text 70 430 count quarter beats;
#X msg 66 290 stop;
#X obj 66 260 t b b;
#N canvas 435 296 450 326 quarter-count 0;
#X obj 30 20 inlet clock;
#X obj 160 20 inlet reset;
#X obj 30 70 f;
#X obj 60 70 + 1;
#X obj 30 99 t f f;
#X obj 30 158 bng 15 250 50 0 empty empty empty 17 7 0 10 #fcfcfc #000000
#000000;
#X msg 160 100 0;
#X obj 30 182 f;
#X obj 70 182 + 1;
#X obj 90 70 mod 24;
#X obj 160 70 bng 15 250 50 0 empty empty empty 17 7 0 10 #fcfcfc #000000
#000000;
#X obj 30 128 sel 0;
#X obj 30 230 outlet count;
#X connect 0 0 2 0;
#X connect 1 0 10 0;
#X connect 2 0 4 0;
#X connect 3 0 9 0;
#X connect 4 0 11 0;
#X connect 4 1 3 0;
#X connect 5 0 7 0;
#X connect 6 0 2 1;
#X connect 6 0 7 1;
#X connect 7 0 8 0;
#X connect 7 0 12 0;
#X connect 8 0 7 1;
#X connect 9 0 2 1;
#X connect 10 0 6 0;
#X connect 11 0 5 0;
#X restore 20 400 pd quarter-count;
#N canvas 504 288 453 379 pulse 0;
#X floatatom 30 142 5 0 0 0 - - -, f 5;
#X obj 30 170 sel 0;
#X obj 30 80 f;
#X obj 60 80 + 1;
#X obj 30 109 t f f;
#X obj 90 80 mod 24;
#X obj 30 199 outlet;
#X obj 30 20 inlet clock;
#X obj 129 20 inlet mod;
#X obj 210 20 inlet set;
#X connect 0 0 1 0;
#X connect 1 0 6 0;
#X connect 2 0 4 0;
#X connect 3 0 5 0;
#X connect 4 0 0 0;
#X connect 4 1 3 0;
#X connect 5 0 2 1;
#X connect 7 0 2 0;
#X connect 8 0 5 1;
#X connect 9 0 5 0;
#X restore 20 140 pd pulse;
#N canvas 829 160 346 501 tracker 0;
#X obj 20 194 timer;
#X floatatom 20 223 0 0 0 0 - - -;
#X obj 20 160 t b b;
#X floatatom 20 279 0 0 0 0 - - -;
#N canvas 650 312 455 460 smooth 0;
#X obj 30 20 inlet;
#X obj 30 155 t f f;
#X obj 30 80 t b f;
#X obj 30 105 f;
#X obj 30 130 expr $f3*$f1+(1-$f3)*$f2;
#N canvas 595 212 510 541 init-filter 0;
#X obj 30 50 swap;
#X obj 30 75 pack f f;
#X obj 30 100 route 0 1;
#X obj 30 20 inlet;
#X obj 30 125 t b f f;
#X obj 30 150 outlet;
#X obj 80 150 outlet;
#X obj 80 20 tgl 15 0 empty empty empty 17 7 0 10 #fcfcfc #000000 #000000
0 1;
#X text 100 70 Branch 0 is only run once \, when we haven't received
any values yet \, to get the filter initialized via outlet #2. Subsequently
\, on branch 1 the current value is simply passed through on outlet
#1., f 56;
#X text 30 200 Non-standard order: During initialization \, outlet
#2 gets the current value \, then outlet #1.;
#X obj 106 20 inlet;
#X connect 0 0 1 0;
#X connect 0 1 1 1;
#X connect 1 0 2 0;
#X connect 2 0 4 0;
#X connect 2 1 5 0;
#X connect 3 0 0 0;
#X connect 4 0 7 0;
#X connect 4 1 5 0;
#X connect 4 2 6 0;
#X connect 7 0 0 1;
#X connect 10 0 7 0;
#X restore 30 50 pd init-filter;
#X obj 30 184 outlet;
#X obj 125 20 bng 15 250 50 0 empty empty empty 17 7 0 10 #fcfcfc #000000
#000000;
#X obj 80 20 inlet;
#X obj 270 20 loadbang;
#X obj 270 93 expr exp(-1/$f1);
#X floatatom 270 115 5 0 0 0 - - -, f 5;
#X floatatom 270 70 5 0 0 0 - - -, f 5;
#X text 310 115 filter gain;
#X obj 270 45 f 0.5;
#X connect 0 0 5 0;
#X connect 1 0 6 0;
#X connect 1 1 3 1;
#X connect 2 0 3 0;
#X connect 2 1 4 1;
#X connect 3 0 4 0;
#X connect 4 0 1 0;
#X connect 5 0 2 0;
#X connect 5 1 3 1;
#X connect 7 0 5 1;
#X connect 8 0 7 0;
#X connect 9 0 14 0;
#X connect 10 0 11 0;
#X connect 11 0 4 2;
#X connect 12 0 10 0;
#X connect 14 0 12 0;
#X restore 20 250 pd smooth;
#X obj 80 220 bng 15 250 50 0 empty empty empty 17 7 0 10 #fcfcfc #000000
#000000;
#X obj 20 100 sel 0 1;
#X obj 20 70 f;
#X obj 38 47 tgl 15 0 empty empty empty 17 7 0 10 #fcfcfc #000000 #000000
0 1;
#X msg 70 47 0;
#X obj 20 308 expr rint($f1);
#X obj 20 130 t b b;
#X obj 120 20 inlet stop;
#X obj 20 20 inlet clock;
#X obj 20 350 outlet tempo;
#X obj 150 350 outlet status;
#X connect 0 0 1 0;
#X connect 1 0 4 0;
#X connect 2 0 0 0;
#X connect 2 1 0 1;
#X connect 3 0 10 0;
#X connect 4 0 3 0;
#X connect 5 0 4 1;
#X connect 6 0 11 0;
#X connect 6 1 2 0;
#X connect 7 0 6 0;
#X connect 8 0 7 1;
#X connect 8 0 15 0;
#X connect 9 0 8 0;
#X connect 10 0 14 0;
#X connect 11 0 0 0;
#X connect 11 1 8 0;
#X connect 12 0 9 0;
#X connect 12 0 5 0;
#X connect 13 0 7 0;
#X restore 150 240 pd tracker;
#X obj 66 320 del 3000;
#X text 30 340 auto-stop after 3 sec;
#X obj 20 370 spigot;
#X obj 70 370 tgl 15 0 empty empty empty 17 7 0 10 #fcfcfc #000000
#000000 0 1;
#X obj 20 108 t b;
#X obj 200 129 f \$1;
#X obj 160 20 inlet;
#X obj 160 50 expr int(24*4/$f1);
#X floatatom 160 79 5 0 0 0 - - -, f 5;
#X obj 500 20 midiin;
#X obj 500 79 sel 242;
#X obj 500 169 pack f f;
#X obj 546 140 t b f;
#X obj 500 108 f 1;
#X obj 500 140 f;
#X obj 500 198 route 1 2;
#X obj 500 227 t b f;
#X obj 530 108 f 2;
#X obj 560 108 f 0;
#X obj 500 256 f;
#X obj 500 285 pack f f;
#X obj 550 227 t b b f;
#X obj 500 314 expr $f2*128+$f1;
#X floatatom 500 343 5 0 0 0 - - -, f 5;
#X text 570 20 SPP;
#X floatatom 500 429 5 0 0 0 - - -, f 5;
#X obj 500 400 expr modf($f1/$f2*6)*$f2;
#X msg 130 174 0;
#X obj 300 20 inlet;
#X obj 500 371 t f f;
#X floatatom 300 49 5 0 0 0 - - -, f 5;
#X text 550 429 clocks in pulse;
#X text 550 343 16ths (clocks/6);
#X text 550 520 next pulse in bar;
#N canvas 250 100 450 378 quant 0;
#X obj 30 80 inlet;
#X obj 30 168 outlet;
#X obj 30 109 expr ceil(rint($f1*16)/16);
#X text 30 20 quantize a fractional pulse - we have to go to some lengths
here to avoid rounding errors, f 53;
#X obj 30 138 mod;
#X obj 80 80 inlet;
#X text 230 90 worst case is 1/1 = 16/16 \, so quantize to 16ths \,
then always round up to get the next pulse number \, and wrap around
to the beginning of the next bar, f 26;
#X connect 0 0 2 0;
#X connect 2 0 4 0;
#X connect 4 0 1 0;
#X connect 5 0 4 1;
#X restore 500 490 pd quant;
#X floatatom 500 519 5 0 0 0 - - -, f 5;
#X obj 500 460 expr modf($f1/$f2*6/$f3)*$f3;
#X obj 500 547 outlet;
#X obj 500 49 spigot;
#X connect 0 0 13 0;
#X connect 1 0 10 0;
#X connect 2 0 6 0;
#X connect 3 0 5 0;
#X connect 4 0 6 1;
#X connect 5 0 4 0;
#X connect 6 0 32 0;
#X connect 7 0 25 1;
#X connect 7 0 27 1;
#X connect 7 0 55 0;
#X connect 8 0 12 0;
#X connect 10 0 11 0;
#X connect 10 1 27 0;
#X connect 10 2 28 0;
#X connect 13 0 21 0;
#X connect 14 0 15 0;
#X connect 15 0 13 1;
#X connect 15 0 66 1;
#X connect 16 0 33 0;
#X connect 17 1 28 1;
#X connect 21 0 32 0;
#X connect 21 2 24 0;
#X connect 23 0 28 0;
#X connect 24 0 7 0;
#X connect 24 1 23 0;
#X connect 25 0 20 0;
#X connect 26 0 1 0;
#X connect 27 0 8 0;
#X connect 27 1 19 0;
#X connect 28 0 7 0;
#X connect 30 0 25 0;
#X connect 31 0 30 1;
#X connect 32 0 26 0;
#X connect 32 0 30 0;
#X connect 33 0 17 0;
#X connect 34 0 35 0;
#X connect 35 0 36 0;
#X connect 36 0 26 1;
#X connect 36 0 54 1;
#X connect 36 0 64 1;
#X connect 37 0 66 0;
#X connect 38 0 41 0;
#X connect 38 1 40 0;
#X connect 39 0 43 0;
#X connect 40 0 42 0;
#X connect 40 1 39 1;
#X connect 41 0 42 1;
#X connect 42 0 39 0;
#X connect 43 0 44 0;
#X connect 43 1 49 0;
#X connect 44 0 45 0;
#X connect 44 1 47 1;
#X connect 45 0 42 1;
#X connect 46 0 42 1;
#X connect 47 0 48 0;
#X connect 48 0 50 0;
#X connect 49 0 46 0;
#X connect 49 1 47 0;
#X connect 49 2 48 1;
#X connect 50 0 51 0;
#X connect 51 0 57 0;
#X connect 53 0 26 2;
#X connect 54 0 53 0;
#X connect 55 0 26 2;
#X connect 56 0 58 0;
#X connect 57 0 54 0;
#X connect 57 1 64 0;
#X connect 58 0 64 2;
#X connect 58 0 62 1;
#X connect 62 0 63 0;
#X connect 63 0 65 0;
#X connect 64 0 62 0;
#X connect 66 0 38 0;
